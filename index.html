<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Libri - Login</title>
    <!-- jQuery library -->
    <script src="jquery.js"></script>

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="estilo.css">

    <script src="script.js"></script>

    <link rel="icon" href="favicon.ico" type="image/x-icon" />

</head>

<body>
    <!--Barra de navegação-->
    <ul class="side-nav" id="mobile-demo">
    </ul>
    <div class="navbar-fixed">
        <nav>
            <div class="nav-wrapper blue-grey darken-4">
                <a id="titulo" href="#" class="brand-logo center">Área Segura</a>

                <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

                <ul class="left hide-on-med-and-down">
                    <a href="#" class="brand-logo left" style="color: #eceff1">Libri Factories</a>
                </ul>

                <ul id="nav-mobile-cliente" class="right hide-on-med-and-down" style="display: none">
                    <li><a onclick="chamarTela('source/cliente/meuspedidos.html', 'Meus Pedidos')">Meus Pedidos</a></li>
                    <li><a onclick="chamarTela('source/cliente/pedido.html', 'Novo Pedido')">Novo Pedido</a></li>
                    <li><a href="" onclick='document.cookie = "usuariologado=;"'>Sair</a></li>
                </ul>
                <ul id="nav-mobile-empresa" class="right hide-on-med-and-down" style="display: none" style="color: #eceff1">
                    <li><a onclick="chamarTela('source/empresa/controlepedidos.html', 'Controle Pedidos');">Controle Pedidos</a></li>
                    <li><a onclick="chamarTela('source/empresa/aprovarencomenda.html', 'Aprovar Encomenda');">Aprovar Encomendas</a></li>
                    <li><a onclick="$('#corpo').load('source/empresa/controleEstoque.html'); $('#corpo').show(); $('#cont2').html(''); $('#cont2').hide(); $('#titulo').html('Controle estoque'); document.title = 'Controle Estoque';">Estoque</a></li>
                    <li><a href="" onclick='document.cookie = "usuariologado=;"'>Sair</a></li>
                </ul>

            </div>
        </nav>
    </div>
    <!--Div da tela de login-->
    <div class="row">
        <div class="container" id="containerLogin">

            <div id="mae" style="background-color: rgba(255,255,255,.1)" class="container">
                <div class="mediadora z-depth-2 fundocadastro">
                    <h5 id="h5-cabecalho">Cadastre-se</h5><br>
                    <div id="progresso" class="ajustar">
                        <div style="background-color: rgba(255,255,255,.1) " class="progress">
                            <div id="progredindo" class="determinate" style="width: 0%"></div>
                        </div>
                        <img id="ok" src="imagens/Icones/ok.png" alt="">

                    </div>
                    <div class="z-depth-2 mediadora conteudo"><br>
                        <div id="divCadastro">
                            <input autofocus class="aumentar" type="text" placeholder="Nome" id="nome">
                            <input autofocus class="aumentar" type="text" placeholder="Sobrenome" id="sobrenome">
                            <input autofocus class="aumentar" type="text" placeholder="Usuario" id="usuario">
                            <input autofocus class="aumentar" type="email" placeholder="Email" id="email">
                            <input autofocus class="aumentar" type="password" placeholder="Senha" id="senha">
                            <input autofocus class="aumentar" type="password" placeholder="Confime sua senha" id="confirmacao">
                            <img id="img_erro_email" src="imagens/Icones/erro.png" alt="">
                            <img id="img_erro_usuario" src="imagens/Icones/erro.png" alt="">
                            <div id="aviso" class="card-panel">
                                <span class="blue-text text-darken-2">AS SENHAS NÃO CONFEREM!</span>
                            </div>
                            <a disabled id="cadastrar" style="margin-top: 8px;" class="waves-effect waves-light btn">CADASTRAR</a>
                        </div>
                        <div id="divCadastrado">
                            <img id="cadastrado" src="imagens/Icones/ok.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
            <div id="dLogin">
                <div id="usuarios">
                    <a id="voltar" class="btn"><i class="material-icons">arrow_back</i></a><br>
                    <div id="user1" class="usuario">
                        <div class="imagem-usuario"></div>
                        <div class="nome-usuario">CLIENTE</div>
                    </div>
                    <div id="user2" class="usuario">
                        <div class="imagem-usuario"></div>
                        <div class="nome-usuario">FUNCIONÁRIO</div>
                    </div>
                    <div id="div-senha">
                        <input id="input-usuario" type="text" class="validate" placeholder="Usuário">
                        <input id="input-senha" type="password" class="validate" placeholder="Senha">
                        <a class="btn" id="btn-entrar" onclick="fazerLogin()">Entrar</a>
                        <div id="aCriarConta"><br><br>Não possui conta? <a id="criarConta" style="cursor: pointer">Crie uma agora!</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Animação carregamento-->
    <div class="col s12">
        <div id="carregamento" class="preloader-wrapper">
            <div class="spinner-layer spinner-blue-only">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div>
        <!-- Scaled in -->
        <div id="carr" class="inativo">
            <a id="scale-demo" href="#!" class="btn-floating btn-large inativo">
                <i class="material-icons">add</i>
            </a>
        </div>
    </div>
    <!--Div em que é carregado conteúdo da página-->
    <div class="container" id="cont2"></div>
    <div class="row" id="corpo"></div>

    <!--Modais || GAMBIARRA || Será melhorado || FAVOR IGNORAR || OBRIGADO-->

    <!-- Modal cancelar pedido -->
    <div id="modal" class="modal">
        <h1>Cancelando pedido</h1>
        <p>Tem certeza de que deseja cancelar o pedido?</p>
        <p>Esta ação não pode ser desfeita</p><br><br>
        <div>
            <a class="waves-effect waves-light btn modal-action modal-close">Voltar</a>
            <a class="waves-effect waves-light btn red darken-4 modal-action modal-close"><i class="material-icons left">cancel</i>Cancelar pedido</a>
        </div>
    </div>
    <!--- Modal Structure NOVA -->
    <div id="modalDetalhesPedido" class="modal">
        <div class="modal-content">
            <div class="pedidoEsquerda">
                <h5>Itens</h5>
                <div class="itensPedido" onmouseleave="sumirImagem(1);">
                    <table class="responsive-table centered highlight">
                        <tbody>
                            <tr class="produtos-lindinhos">
                                <td><a onclick="iC(1,1);" class='item'>Produto 1</a></td>
                            </tr>
                            <tr class="produtos-lindinhos">
                                <td><a onclick="iC(1,2);" class='item'>Produto 2</a></td>
                            </tr>
                            <tr class="produtos-lindinhos">
                                <td><a onclick="iC(1,3);" class='item'>Produto 3</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div id="materiasPrimas" class="materiasPrimas">
                    <h5>Materia-prima a comprar</h5>
                    PET - R$50,00<br> Polipropileno - R$30,00
                    <hr> Total: R$80,00
                </div>
                <div id="tempoEstimado">
                    <h5>Tempo estimado</h5>
                    Importar materia-prima - 3 dias<br> Producao - 4 dias<br> Envio - 5 anos
                    <hr> Total: 5 anos e 7 dias
                </div>
            </div>
            <div id="pedidoDireita" class="pedidoDireita">
                <h5 style="text-align: center" id="nomeProduto">Shulambs</h5>
                <hr>
                <div class="pd">
                    <div id="detalhes-esquerda" class="detalhes-esquerda">
                        <div id="preco-unitario"></div><br>
                        <div id="preco-total"></div>
                        <div id="custo-producao"></div>
                    </div>
                    <div id="imagemProduto" class="imagemProduto"></div>
                </div>
                <div id="descricaoProduto" class="descricaoProduto"></div>
            </div>
        </div>
        <hr>
        <div id="parteLegal" style="float: right">
            <a href="#!" class="btn modal-action modal-close waves-effect waves-green">Rejeitar</a>
            <a href="#!" class="btn modal-action modal-close waves-effect waves-green">Aprovar</a>
        </div>
    </div>
    
    <!-- Modal Structure Brian-->
    <div id="veritens" class="modal modal-fixed-footer">
        <div class="modal-content">
            <h4>Aprovar itens do pedido <span id="codpedido"></span></h4>
            <ul class="collection" id="itensModal">
            </ul>
        </div>
        <div class="modal-footer">
            <span id="cancelaModal"><a href="#!" class="modal-action modal-close waves-effect waves-red btn  red darken-4">Cancelar</a></span>
            <span id="confirmaModal"><a href="#!" class="modal-action modal-close waves-effect waves-green btn green lighten-4">Aprovar</a></span>
        </div>
    </div>
    <!-- Modal Structure Isabela -->
    <div id="modal1" class="modal">
        <div class="modal-content">
            <h4>Carrinho</h4>
            <table class="highlight responsive-table centered">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Quantidade</th>
                        <th>Cor da tampa</th>
                        <th>Cor da embalagem</th>
                        <th>Preço</th>
                        <th></th>
                    </tr>
                </thead>

                <tbody id="carrinho">
                    <tr>
                        <td>Frasco</td>
                        <td><input class="required" type="number" value="50" style="text-align: center" class="validate" min="50" max="200" step="10"></td>
                        <td>Azul</td>
                        <td>Transparente</td>
                        <td>R$60.00</td>
                        <td><i class="small material-icons">delete_forever</i>
                            <td>
                    </tr>
                    <tr>
                        <td>Frasco</td>
                        <td><input class="required" type="number" value="50" style="text-align: center" class="validate" min="50" max="200" step="10"></td>
                        <td>Azul</td>
                        <td>Transparente</td>
                        <td>R$60.00</td>
                        <td><i class="small material-icons">delete_forever</i>
                            <td>
                    </tr>
                    <tr>
                        <td>Frasco</td>
                        <td><input class="required" type="number" value="50" style="text-align: center" class="validate" min="50" max="200" step="10"></td>
                        <td>Azul</td>
                        <td>Transparente</td>
                        <td>R$60.00</td>
                        <td><i class="small material-icons">delete_forever</i>
                            <td>
                    </tr>
                </tbody>
            </table>
            <hr>
            <h4 align="right">Valor Total: R$<span id="valorTotal">0,00</span> </h4>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Continuar Comprando</a>
            <a href="source/cliente/orcamento.html" class="modal-action modal-close waves-effect waves-green btn-flat">Finalizar Compra</a>
        </div>
    </div>
</body>

<script>
    
    aumentar('nome');
    aumentar('usuario');
    aumentar('sobrenome');
    aumentar('email');
    aumentar('senha');
    aumentar('confirmacao');

    
    $("#cadastrar").click(function() {
        var usuario, senha, nome, sobrenome, email;
        usuario = $("#usuario").val();
        senha = $("#senha").val();
        nome = $("#nome").val();
        sobrenome = $("#sobrenome").val();
        email = $("#email").val();


        $.ajax({
            url: 'http://127.0.0.1:880?usuario=' + usuario + '&senha=' + senha + '&nome=' + nome + '&sobrenome=' + sobrenome + '&email=' + email + '&operacao=cadastrarCliente',
            success: function(result) {
                if (result.status == 'OK') {
                    $("#divCadastro").hide(600);
                    setTimeout(function() {
                        $("#divCadastrado").slideDown(300);
                    }, 300);
                    $("#ok").hide(200);
                    $("#h5-cabecalho").html('Cadastro Efetuado, <br> seja bem vindo!');
                    setTimeout(function() {
                        $("#mae").slideUp(500);
                        $("#dLogin").slideDown(500);
                    }, 3000);
                } else {
                    $("#divCadastro").hide(600);
                    setTimeout(function() {
                        $("#divCadastrado").slideDown(300);
                    }, 300);
                    document.getElementById("cadastrado").src = "imagens/Icones/erro.png"; 
                    $("#ok").hide(200);
                    $("#h5-cabecalho").html('Nao foi possivel, <br> efetivar o cadastro!');
                    setTimeout(function() {
                       setTimeout(function(){
                           window.location.reload();
                       },600);
                    }, 3000);
                }
            }
        });
    });//ok
    /*VERIFICA SE EXISTE UM EMAIL OU UM USUARIO COM OS DADOS PREENCHIDOS NO FORMULARIO*/
    function verificarSeExiste(id){
        if(id == 'email'){
            var email = $("#email").val();
            $.ajax({
                url: 'http://127.0.0.1:880?email='+email+'&operacao=consultarEmail',
                success: function(result){
                    if(result == true){
                        $("#email").addClass('existente');
                        $("#img_erro_email").show(300);
                        if($("#email").val() != '')Materialize.toast('Esse e-mail já foi cadastrado meu querido(a), tente outro!', 4000);
                    }else{
                        $("#email").removeClass('existente');
                        $("#img_erro_email").hide(300);
                    }
                }
            });
        }
        if(id == 'usuario'){
            var usuario = $("#usuario").val();
            $.ajax({
                url: 'http://127.0.0.1:880?usuario='+usuario+'&operacao=consultarUsuario',
                success: function(result){
                       if(result == true){
                        $("#usuario").addClass('existente');
                           $("#img_erro_usuario").show(300);
                            Materialize.toast('Esse usuario está indisponivel, tente outro por favor!', 4000);
                    }else{
                        $("#usuario").removeClass('existente');
                        $("#img_erro_usuario").hide(300);
                    }
                }
            });
        }
    }

    function aumentar(id) {        
        $("#" + id).focusin(function() {
            $("#" + id).addClass('ativo');
        });
        $("#" + id).focusout(function() {
            $("#" + id).removeClass('ativo');
        });
    }
    
    $("#email").blur(function(){
            verificarSeExiste('email');
               });    
    
    $("#usuario").blur(function(){
            verificarSeExiste('usuario');
               });
    

    function checarProgresso() {
        var progresso = 0;
        if ($("#nome").val() != '') progresso += 20;
        if ($("#sobrenome").val() != '') progresso += 20;
        if ($("#email").val() != '') progresso += 20;
        if ($("#usuario").val() != '') progresso += 20;
        if ($("#confirmacao").val() != '') {
            if ($("#confirmacao").val() != $("#senha").val() && $("#confirmacao").val() != $("#senha").val())
                $("#aviso").show(600);
            else {
                progresso += 20;
                $("#aviso").hide(600);
            }

        }
        if ($("#confirmacao").val() == '' && $("#senha").val() == '')
            $("#aviso").hide(600);

        document.getElementById("progredindo").style.width = progresso + "%";
        if (progresso == 100) {
            $("#ok").show(300);
            document.getElementById("cadastrar").removeAttribute('disabled');
        } else {
            $("#ok").hide(300);
            document.getElementById("cadastrar").setAttribute('disabled', 'disabled');
        }
    }

    $("#nome").keyup(function(e) {
        checarProgresso();
    });
    $("#sobrenome").keyup(function(e) {
        checarProgresso();
    });
    $("#usuario").keyup(function(e) {
        checarProgresso();
    });
    $("#email").keyup(function(e) {
        checarProgresso();
    });
    $("#senha").keyup(function(e) {
        checarProgresso();
    });
    $("#confirmacao").keyup(function(e) {
        checarProgresso();
    });

</script>

</html>
